# عجلة الولاء | QR Loyalty Wheel

PWA لفندق: الزبون يمسح QR → يلعب العجلة → يفوز بجائزة + كود → إما عرض فئته ونقاطه (إن مسجّل) أو التسجيل ثم إرسال واتساب للاستقبال.

## تشغيل المشروع

```bash
npm install
npm run dev
```

- **صفحة الزبون:** `http://localhost:5174/`
- **لوحة التحكم (الأدمن):** `http://localhost:5174/admin`

## ما تم تنفيذه

- **طبقة تخزين مؤقت (localStorage):** حفظ الملفات المرفوعة والإعدادات حتى ربط Firebase لاحقاً.
- **صفحة الزبون (أولوية موبايل):**
  - عجلة حظ + كود + نسخ/واتساب → طلب الجوال → عرض الفئة والنقاط (إن مسجّل) أو نموذج تسجيل (إن جديد).
- **صفحة الأدمن:** 4 أيقونات رفع (فضي، ذهبي، بلاتيني، كشف الإيراد) + إعداد النقاط والترقية ورقم واتساب ونصوص الرسائل.
- **ربط الزبون بالتخزين:** البحث من الملفات المرفوعة، النقاط من كشف الإيراد، التسجيل الجديد يُضاف للفضي.

## المتبقي

- **Firebase:** استبدال التخزين المؤقت بـ Firestore (الخطوة الأخيرة حسب خطة المشروع).
- **اختبار التدفق الكامل** بعد رفع ملفات تجريبية من الأدمن.

## البنية

- `src/pages/GuestPage.tsx` — صفحة الزبون
- `src/pages/AdminPage.tsx` — لوحة التحكم
- `src/components/Wheel.tsx` — عجلة الحظ
- `src/services/storage.ts` — التخزين المؤقت
- `src/services/lookup.ts` — البحث عن الضيف وحساب النقاط
- `src/services/excelParser.ts` — قراءة ملفات Excel
- **`docs/`** — توثيق: `docs/README.md`، `docs/DEPLOYMENT.md`
- **اختبارات الوحدة:** `npm run test`
- **اختبارات E2E:** `npm run test:e2e` (Playwright)

## قبل النشر

- **تحقق تلقائي:** شغّل `npm run check` (بناء + اختبارات وحدة) — أمر واحد بدون خطوات إضافية.
- **نشر كامل:** شغّل `deploy.bat` — ينفّذ التحقق ثم رفع GitHub ثم Firebase دون أوامر منفصلة.
- إعداد لمرة واحدة (`.env`، كود الأدمن على السيرفر): راجع **`docs/DEPLOYMENT.md`**.
